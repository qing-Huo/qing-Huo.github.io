# 网络小结

## 数据链路层 以太网协议

- 以太网协议：
    1. 以太的数据称作数据帧，分为head+data来那个部分，其中head 长度固定
    2. 规定介入互联网的主机必须有一块网卡，网卡上有一个 mac 地址，全球唯一
    3. 以太网协议的通信: 广播通信 

## 网络层 

### IP协议

- ip 地址分为两部分
    * 网络部分： 标识子网
    * 主机部分： 标识主机

NOTE: 单纯的ip地址段只标识了ip地址的种类，从网络部分或主机部分都无法辨别一个ip所处的子网

例：172.16.10.1与172.16.10.2并不能确定二者处于同一子网

ip地址 + mac 地址 == 全球范围内唯一一台计算机

ip 地址的范围
```
00000000.00000000.00000000.00000000 -> 0.0.0.0
11111111.11111111.11111111.11111111 -> 255.255.255.255
```

***

- 子网掩码

所谓”子网掩码”，就是表示子网络特征的一个参数。它在形式上等同于IP地址，也是一个32位二进制数字，它的网络部分全部为1，主机部分全部为0。比如，IP地址172.16.10.1，如果已知网络部分是前24位，主机部分是后8位，那么子网络掩码就是11111111.11111111.11111111.00000000，写成十进制就是255.255.255.0。

知道”子网掩码”，我们就能判断，任意两个IP地址是否处在同一个子网络。方法是将两个IP地址与子网掩码分别进行AND运算（两个数位都为1，运算结果为1，否则为0），然后比较结果是否相同，如果是的话，就表明它们在同一个子网络中，否则就不是。

eg: 已知IP地址172.16.10.1和172.16.10.2的子网掩码都是255.255.255.0，请问它们是否在同一个子网络？两者与子网掩码分别进行AND运算

```
10101100.00010000.00001010.00000001    -> 172.16.10.1
11111111.11111111.11111111.00000000    -> 255.255.255.255.0 

10101100.00010000.00001010.00000000    -> 172.16.10.0 #子网地址

10101100.00010000.00001010.00000010    -> 172.16.10.2
11111111.11111111.11111111.00000000    -> 255.255.255.255.0

10101100.00010000.00001010.00000010    -> 172.16.10.0 #子网地址
```
结果都是172.16.10.0，因此它们```在同一个子网络(同一个LAN(局域网)中)```。

IP协议的作用主要有两个，一个是为每一台计算机分配IP地址，另一个是确定哪些地址在同一个子网络。

### ARP协议

- 计算机通信分类：
    * 局域网内通信
    * 跨局域网通信

计算机A如何与计算机B通信？

```
需要拿到计算机B的 mac 地址
由 ARP协议 判断：
    如果两台计算机的子网地址相同
        计算机A发送ARP协议数据包,ARP数据包组成如下
            发送方的mac地址 FF-FF-FF-FF-FF-FF 发送方的IP 接收方的IP 数据部分
        LAN内所有计算机都收到该ARP包，
            遇到 FF-FF-FF-FF-FF-FF ，子网内计算机都知道通信方需要自身的mac地址
            子网内所有计算机会去校验 目标IP,如果是自身的，就返回mac地址

    如果两台计算机的子网地址不同
        尝试获取 网关(路由器) 的mac地址
            发送方mac地址 FF-FF-FF-FF-FF-FF 发送方ip 网关的ip 数据部分
        发送数据
            发送方mac 网关的mac 发送方ip 接收方ip 数据部分
```


在同一个 LAN(局域网) 内，通信依靠 mac 地址。只要知道目标主机的 mac 地址，就能建立通信


